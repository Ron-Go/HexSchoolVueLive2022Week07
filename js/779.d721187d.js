"use strict";(self["webpackChunkproject2022"]=self["webpackChunkproject2022"]||[]).push([[779],{779:function(a,e,t){t.r(e),t.d(e,{default:function(){return Ja}});var o=t(252),l=t(35);const n={class:"container position-relative",style:{height:"100vh"}},s={class:"row",ref:"manageDom"},i={class:"col-12 d-flex justify-content-end my-3"},c={class:"col-12"},d={class:"table table-hover"},r=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"分類"),(0,o._)("th",null,"產品名稱"),(0,o._)("th",null,"星級評等"),(0,o._)("th",null,"原價"),(0,o._)("th",null,"售價"),(0,o._)("th",null,"是否啟用"),(0,o._)("th",{width:"120px"},"管理")])],-1),u={class:"text-right"},m={class:"text-right"},g={class:"btn-group"},p=["onClick"],h=["onClick"];function b(a,e,t,b,_,v){const f=(0,o.up)("pagination"),w=(0,o.up)("manageModal"),M=(0,o.up)("statusModal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",n,[(0,o._)("div",s,[(0,o._)("div",i,[(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=(...a)=>v.addProduct&&v.addProduct(...a))},"建立新產品")]),(0,o._)("div",c,[(0,o._)("table",d,[r,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.tempProducts,((a,e)=>((0,o.wg)(),(0,o.iD)("tr",{key:"key"+e},[(0,o._)("td",null,(0,l.zw)(a.category),1),(0,o._)("td",null,(0,l.zw)(a.title),1),(0,o._)("td",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.tempProducts[e].rating,((a,e)=>((0,o.wg)(),(0,o.iD)("span",{key:"star"+e,class:"text-warning"},"☆")))),128))]),(0,o._)("td",u,(0,l.zw)(a.origin_price),1),(0,o._)("td",m,(0,l.zw)(a.price),1),(0,o._)("td",{class:(0,l.C_)([{"text-success":1==a.is_enabled},"fw-bold"])},(0,l.zw)(""+(1==a.is_enabled?"啟用":"不啟用")),3),(0,o._)("td",g,[(0,o._)("button",{type:"button",class:"btn btn-outline-success btn-sm",onClick:e=>v.modifyProduct(a)},"編輯",8,p),(0,o._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>v.deleteProduct(a)},"刪除",8,h)])])))),128))])])])],512),(0,o.Wm)(f,{pagination:_.pagination,onSendPage:v.getData},null,8,["pagination","onSendPage"])]),(0,o.Wm)(w,{ref:"manageModal",manageMode:_.manageMode,manageProduct:_.manageProduct,onConfirmManage:v.confirmManage,onCancelManage:v.cancelManage},null,8,["manageMode","manageProduct","onConfirmManage","onCancelManage"]),(0,o.Wm)(M,{ref:"statusModal"},null,512)],64)}var _=t(577),v=t(963);const f={class:"modal-dialog modal-xl modal-dialog-scrollable"},w={class:"modal-content"},M={class:"modal-header"},y={class:"modal-title"},P={key:0},k={key:1},U={key:2},x={class:"modal-body"},C={key:0,action:""},D={class:"container-fluid"},$={class:"row"},V={class:"col-5"},z={class:"mb-3"},Z=["src"],q={for:"imgUrl",class:"form-label fs-5 fw-bold w-100"},H=(0,o.Uk)("商品主圖網址 "),L={key:0,class:"mb-3"},S=(0,o._)("h5",null,"商品副圖網址",-1),Y=["src"],K={class:"form-label w-100",for:"url"},j=["onUpdate:modelValue","placeholder"],N={class:"col-7"},W={class:"row mb-3"},A={class:"col-9 ms-auto"},J={for:"title",class:"form-label w-100"},O=(0,o.Uk)("名稱 "),T={class:"col-3 ms-auto"},E={for:"category",class:"form-label w-100"},F=(0,o.Uk)("分類 "),R=(0,o._)("option",{value:"",disabled:""},"商品分類",-1),B=(0,o._)("option",{value:"食品"},"食品",-1),G=(0,o._)("option",{value:"美容"},"美容",-1),I=[R,B,G],Q={class:"row mb-3"},X={class:"col-3 mb-3"},aa={for:"origin_price",class:"form-label w-100"},ea=(0,o.Uk)("原價 "),ta={class:"col-3"},oa={for:"price",class:"form-label w-100"},la=(0,o.Uk)("價格 "),na={class:"col-2"},sa={for:"unit",class:"form-label w-100"},ia=(0,o.Uk)("商品單位 "),ca=(0,o._)("option",{value:"",disabled:""},"商品單位",-1),da=(0,o._)("option",{value:"個"},"個",-1),ra=(0,o._)("option",{value:"支"},"支",-1),ua=(0,o._)("option",{value:"公斤"},"公斤",-1),ma=[ca,da,ra,ua],ga={class:"col-12 mb-3"},pa={for:"content",class:"form-label w-100"},ha=(0,o.Uk)("商品內容 "),ba={class:"col-12"},_a={for:"description",class:"form-label w-100"},va=(0,o.Uk)("商品描述 "),fa={class:"row"},wa={class:"col-3"},Ma={for:"rating",class:"form-label w-100"},ya=(0,o.Uk)("評等 "),Pa=(0,o.uE)('<option value="" disabled>選擇商品星級評等</option><option class="text-danger" value="1">☆</option><option value="2">☆☆</option><option value="3">☆☆☆</option><option value="4">☆☆☆☆</option><option value="5">☆☆☆☆☆</option>',6),ka=[Pa],Ua={class:"col-4 mt-4"},xa={for:"enable",class:"form-label"},Ca=(0,o.Uk)("是否啟用 "),Da={key:1,class:"div"},$a=(0,o._)("h5",{class:"text-danger"},"確認刪除此品項",-1),Va={class:"modal-footer"},za={key:0},Za={key:1},qa={key:2};function Ha(a,e,t,n,s,i){return(0,o.wg)(),(0,o.iD)("div",{class:"modal fade",tabindex:"-1",id:"myModal","data-bs-backdrop":"static",onKeyup:e[15]||(e[15]=(0,v.D2)((e=>a.$emit("cancel-manage")),["esc"]))},[(0,o._)("div",f,[(0,o._)("div",w,[(0,o._)("div",M,[(0,o._)("h5",y,[1==t.manageMode?((0,o.wg)(),(0,o.iD)("span",P,"建立新產品")):2==t.manageMode?((0,o.wg)(),(0,o.iD)("span",k,"編輯產品")):3==t.manageMode?((0,o.wg)(),(0,o.iD)("span",U,"刪除產品")):(0,o.kq)("",!0)]),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(0,v.iM)((e=>a.$emit("cancel-manage")),["prevent"]))})]),(0,o._)("div",x,[2==t.manageMode||1==t.manageMode?((0,o.wg)(),(0,o.iD)("form",C,[(0,o._)("div",D,[(0,o._)("div",$,[(0,o._)("div",V,[(0,o._)("div",z,[(0,o._)("img",{class:"img-fluid d-block mb-3",src:t.manageProduct.imageUrl,alt:""},null,8,Z),(0,o._)("label",q,[H,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"imgUrl",placeholder:"輸入主圖網址","onUpdate:modelValue":e[1]||(e[1]=a=>s.localProduct.imageUrl=a)},null,512),[[v.nr,s.localProduct.imageUrl]])])]),Array.isArray(s.localProduct.imagesUrl)?((0,o.wg)(),(0,o.iD)("div",L,[S,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.localProduct.imagesUrl,((a,e)=>((0,o.wg)(),(0,o.iD)(o.HY,{key:"img"+e},[(0,o._)("img",{class:"img-fluid",src:s.localProduct.imagesUrl[e],alt:""},null,8,Y),(0,o._)("label",K,[(0,o.Uk)("副圖網址"+(0,l.zw)(`${e+1}`)+" ",1),(0,o.wy)((0,o._)("input",{type:"text",id:"url",class:"form-control mb-3","onUpdate:modelValue":a=>s.localProduct.imagesUrl[e]=a,placeholder:`輸入副圖網址${e+1}`},null,8,j),[[v.nr,s.localProduct.imagesUrl[e]]])])],64)))),128)),!s.localProduct.imagesUrl.length||s.localProduct.imagesUrl[s.localProduct.imagesUrl.length-1]?((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:"btn btn-primary w-100 mb-3",onClick:e[2]||(e[2]=a=>s.localProduct.imagesUrl.push(""))},"新增")):(0,o.kq)("",!0),(0,o._)("button",{type:"button",class:"btn btn-outline-danger w-100",onClick:e[3]||(e[3]=a=>s.localProduct.imagesUrl.pop(""))},"刪除最後一個")])):(0,o.kq)("",!0)]),(0,o._)("div",N,[(0,o._)("div",W,[(0,o._)("div",A,[(0,o._)("label",J,[O,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=a=>s.localProduct.title=a),class:"form-control",id:"title",placeholder:"輸入名稱"},null,512),[[v.nr,s.localProduct.title]])])]),(0,o._)("div",T,[(0,o._)("label",E,[F,(0,o.wy)((0,o._)("select",{id:"category","onUpdate:modelValue":e[5]||(e[5]=a=>s.localProduct.category=a),class:"form-select"},I,512),[[v.bM,s.localProduct.category]])])])]),(0,o._)("div",Q,[(0,o._)("div",X,[(0,o._)("label",aa,[ea,(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",min:"0",id:"origin_price",placeholder:"輸入原價","onUpdate:modelValue":e[6]||(e[6]=a=>s.localProduct.origin_price=a)},null,512),[[v.nr,s.localProduct.origin_price,void 0,{number:!0}]])])]),(0,o._)("div",ta,[(0,o._)("label",oa,[la,(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",min:"0",id:"price",placeholder:"輸入價格","onUpdate:modelValue":e[7]||(e[7]=a=>s.localProduct.price=a)},null,512),[[v.nr,s.localProduct.price,void 0,{number:!0}]])])]),(0,o._)("div",na,[(0,o._)("label",sa,[ia,(0,o.wy)((0,o._)("select",{id:"unit","onUpdate:modelValue":e[8]||(e[8]=a=>s.localProduct.unit=a),class:"form-select"},ma,512),[[v.bM,s.localProduct.unit]])])]),(0,o._)("div",ga,[(0,o._)("label",pa,[ha,(0,o.wy)((0,o._)("textarea",{type:"text",class:"form-control",name:"content",id:"content",cols:"30",rows:"3","onUpdate:modelValue":e[9]||(e[9]=a=>s.localProduct.content=a),placeholder:"輸入商品內容"},null,512),[[v.nr,s.localProduct.content]])])]),(0,o._)("div",ba,[(0,o._)("label",_a,[va,(0,o.wy)((0,o._)("textarea",{type:"text",class:"form-control",name:"description",id:"description",cols:"30",rows:"3","onUpdate:modelValue":e[10]||(e[10]=a=>s.localProduct.description=a),placeholder:"輸入商品描述"},null,512),[[v.nr,s.localProduct.description]])])])]),(0,o._)("div",fa,[(0,o._)("div",wa,[(0,o._)("label",Ma,[ya,(0,o.wy)((0,o._)("select",{class:"form-select","onUpdate:modelValue":e[11]||(e[11]=a=>s.localProduct.rating=a),name:"rating",id:"rating"},ka,512),[[v.bM,s.localProduct.rating,void 0,{number:!0}]])])]),(0,o._)("div",Ua,[(0,o._)("label",xa,[Ca,(0,o.wy)((0,o._)("input",{type:"checkbox",class:"form-check-input",id:"enable",value:"1","onUpdate:modelValue":e[12]||(e[12]=a=>s.localProduct.is_enabled=a),"true-value":"1","false-value":"0"},null,512),[[v.e8,s.localProduct.is_enabled]])])])])])])])])):3===t.manageMode?((0,o.wg)(),(0,o.iD)("div",Da,[$a,(0,o._)("h5",null,(0,l.zw)(s.localProduct.title),1)])):(0,o.kq)("",!0)]),(0,o._)("div",Va,[(0,o._)("button",{type:"submit",class:"btn btn-outline-danger",onClick:e[13]||(e[13]=(0,v.iM)((e=>a.$emit("cancel-manage")),["prevent"])),"data-bs-dismiss":"modal"},"取消 "),(0,o._)("button",{type:"submit",class:(0,l.C_)(["btn text-white",{"btn-primary":1==t.manageMode,"btn-success":2==t.manageMode,"btn-danger":3==t.manageMode}]),onClick:e[14]||(e[14]=(0,v.iM)((e=>a.$emit("confirm-manage",s.localProduct)),["prevent"]))},[1==t.manageMode?((0,o.wg)(),(0,o.iD)("span",za,"新增")):2==t.manageMode?((0,o.wg)(),(0,o.iD)("span",Za,"編輯")):3==t.manageMode?((0,o.wg)(),(0,o.iD)("span",qa,"刪除")):(0,o.kq)("",!0)],2)])])])],32)}var La={data(){return{localProduct:{}}},props:["manageMode","manageProduct"],mounted(){},watch:{manageProduct(){this.localProduct={...this.manageProduct}}}},Sa=t(744);const Ya=(0,Sa.Z)(La,[["render",Ha]]);var Ka=Ya,ja=t(53),Na=t(364),Wa={data(){return{tempProducts:{},manageProduct:{imagesUrl:[]},manageMode:0,pagination:{},manageModal:{},statusModal:{},loader:{},containerRefs:{}}},components:{manageModal:Ka,pagination:ja.Z,statusModal:Na.Z},mounted(){this.manageModal=new _.Modal(document.querySelector("#myModal")),this.statusModal=new _.Modal(document.querySelector("#statusModal")),this.getData()},methods:{getData(a=1){this.onLoading(),this.axios.get(`https://vue3-course-api.hexschool.io/v2/api/vue2022ron/admin/products/?page=${a}`).then((a=>{this.tempProducts=a.data.products,this.pagination=a.data.pagination,this.offLoading()})).catch((()=>{}))},addProduct(){this.manageModal.show(),this.manageMode=1},modifyProduct(a){this.manageModal.show(),this.manageMode=2,this.manageProduct=JSON.parse(JSON.stringify(a))},deleteProduct(a){this.manageModal.show(),this.manageMode=3,this.manageProduct={...a}},confirmManage(a){1===this.manageMode?this.axios.post("https://vue3-course-api.hexschool.io/v2/api/vue2022ron/admin/product",{data:a}).then((a=>{this.getData(),this.manageProduct={},this.manageMode=0,this.manageModal.hide(),this.returnMessage(a.data.message,1e3)})).catch((a=>{console.dir(a),this.returnMessage(a.data.message,1e3)})):2===this.manageMode?this.axios.put(`https://vue3-course-api.hexschool.io/v2/api/vue2022ron/admin/product/${a.id}`,{data:a}).then((a=>{this.getData(this.pagination.current_page),this.manageProduct={},this.manageMode=0,this.manageModal.hide(),this.returnMessage(a.data.message,1e3)})).catch((a=>{this.returnMessage(a.data.message,1e3)})):3===this.manageMode&&this.axios.delete(`https://vue3-course-api.hexschool.io/v2/api/vue2022ron/admin/product/${a.id}`).then((a=>{this.manageModal.hide(),this.returnMessage(a.data.message,1e3),this.manageMode=0,this.getData(this.pagination.current_page)})).catch((a=>{this.manageModal.hide(),this.returnMessage(a.data.message,1e3)}))},cancelManage(){this.manageProduct={imagesUrl:[]},this.manageMode=0},onLoading(){this.loader=this.$loading.show({isFullPage:!1,container:this.$refs.manageDom,canCancel:!1,onCancel:this.onCancel,loader:"dots",width:64,height:64,backgroundColor:"#ffffff",opacity:.5})},offLoading(){setTimeout((()=>{this.loader.hide()}),0)},returnMessage(a,e=2e3){setTimeout((()=>{this.$refs.statusModal.textContent=a,this.statusModal.show()}),e)}}};const Aa=(0,Sa.Z)(Wa,[["render",b]]);var Ja=Aa},53:function(a,e,t){t.d(e,{Z:function(){return _}});var o=t(252),l=t(35),n=t(963);const s={"aria-label":"Page navigation example"},i={class:"pagination justify-content-center"},c=(0,o._)("span",{"aria-hidden":"true"},"«",-1),d=[c],r=["onClick"],u=(0,o._)("span",{"aria-hidden":"true"},"»",-1),m=[u];function g(a,e,t,c,u,g){return(0,o.wg)(),(0,o.iD)("nav",s,[(0,o._)("ul",i,[(0,o._)("li",{class:(0,l.C_)(["page-item",{disabled:!t.pagination.has_pre}])},[(0,o._)("a",{class:"page-link",href:"#",onClick:e[0]||(e[0]=(0,n.iM)((e=>a.$emit("send-page",t.pagination.current_page-1)),["prevent"])),"aria-label":"Previous"},d)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.pagination.total_pages,((e,s)=>((0,o.wg)(),(0,o.iD)("li",{class:(0,l.C_)(["page-item",{active:e===t.pagination.current_page}]),key:"page"+s},[(0,o._)("a",{class:"page-link",href:"#",onClick:(0,n.iM)((t=>a.$emit("send-page",e)),["prevent"])},(0,l.zw)(e),9,r)],2)))),128)),(0,o._)("li",{class:(0,l.C_)(["page-item",{disabled:!t.pagination.has_next}])},[(0,o._)("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=(0,n.iM)((e=>a.$emit("send-page",t.pagination.current_page+1)),["prevent"])),"aria-label":"Next"},m)],2)])])}var p={props:["pagination"],data(){return{}}},h=t(744);const b=(0,h.Z)(p,[["render",g]]);var _=b},364:function(a,e,t){t.d(e,{Z:function(){return b}});var o=t(252),l=t(35);const n={class:"modal fade",id:"statusModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},s={class:"modal-dialog"},i={class:"modal-content"},c=(0,o._)("div",{class:"modal-header bg-secondary"},[(0,o._)("h5",{class:"modal-title text-white",id:"exampleModalLabel"},"訊息提示"),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),d={class:"modal-body"},r={class:"fs-4"},u=(0,o._)("div",{class:"modal-footer"},[(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉")],-1);function m(a,e,t,m,g,p){return(0,o.wg)(),(0,o.iD)("div",n,[(0,o._)("div",s,[(0,o._)("div",i,[c,(0,o._)("div",d,[(0,o._)("p",r,(0,l.zw)(g.textContent),1)]),u])])])}var g={data(){return{textContent:""}}},p=t(744);const h=(0,p.Z)(g,[["render",m]]);var b=h}}]);